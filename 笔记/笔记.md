```组件停更分析
服务与注册中心:
eureka 停更
zookeeper  保守
consul go语言写的，不是很推荐
nacos 阿里 推荐

服务调用:
ribbon 继续使用 停止更新
loadBalancer  未来

netfix公司
feign
openfeign 推荐

服务降级:
hystrix 大规模使用
resilience4j 官网推荐 国内推荐较少
sentienl alibab 国内

服务网关:
Zuul  netfix公司
gateway spring自己出的

服务配置:
config 可以
Nacos 后来居上

服务总线:
Bus 
Nacos 
```


---------------------FAQ------------------------

先启动eureka7001，7002 再启动payment8001,8002

在hosts中配置ip映射
127.0.0.1 eureka7001.com
127.0.0.1 eureka7002.com

如果工程运行提示程序包不存在，找到工程目录，输入以下命令：
mvn idea:module,然后再clean install就可以了

---------------------FAQ------------------------

HA(高可用)
Ribbon本地负载均衡，在调用微服务接口的时候，会在注册中心上获取注册信息服务列表之后缓存到JVM本地，而在本地实现RPC远程服务调用技术

eureka-client自带了spring-cloud-starter-ribbon的引用

ribbon+restTemplate 实现负载均衡

getForObject() 返回对象为响应体中转化的对象，基本可以理解为json

getForEntity，返回对象为ResponcesEntity对象，包含了响应中的一些重要信息，比如响应头，响应状态码、响应体等。



负载均衡策略 7种
RoundRobinRule 轮询
RandomRule 随机
RetryRule 先按照RoundRobinRule的策略获取服务，如果获取服务失败则在指定时间内会进行重试，获取可用的服务
WeightedResponseTimeRule 对RoundRobinRule的扩展，响应速度越快的实例选择权重越大，越容易被选择
BestAvailableRule 会优先过滤掉由于多次访问故障而处理断路器跳闸状态的服务，然后选择一个并发量最小的服务
AvailabilityFilteringRule 先过滤掉故障实例，再选择兵法较小的实例
ZoneAvoidanceRule 默认规则，复合判断server所在区域的行能和server的可用性选择服务器

切换自定义的均衡策略
这个自定义配置类不能放在被@ComponentScan所扫描的当前包下以及子包下，
否则我们自定义的这个配置类就会被所有的Ribbon客户端所共享，达不到特殊化定制的目的了。

@RibbonClient注解，加在需要负载均衡访问服务的启动类上
使用自定义的均衡策略
指定服务是服务名
configuration = 自定义的负载均衡策略

负载均衡算法：rest接口第几次请求数 % 服务器集群总数量 = 实际调用服务器位置下标，每次服务重启后rest接口计数从1开始。


--------------------feign-----------------

feign是一个声明式webservice服务端，使用feign能让编写webservice客户端更加简单。
它的使用方法是定义一个服务接口然后在上面添加注解。feign也支持可拔插式的编码器和编译器。
spring cloud对feign进行了封装，使其支持了spring mvc标准注解和HttpMessageConverters。
feign可以与eureka和ribbon组合使用以支持负载均衡。

------------------feign能干什么----------------
feign旨在使编写java http客户端变得更容易
前面在使用编写ribbon+rest template时，利用restTemplate对http请求的封装处理，形成了一套模板化的调用方式。
但是在实际开发中，由于对服务依赖的调用可能不止一处，往往一个接口会被多处调用，所以通常都会针对每个微服务自行封装一些客户端类来包装
这些依赖服务的调用，所以，feign在基础上做了进一步封装，他来帮助我们自定义和实现依赖服务接口的定义。在feign的实现下，我们只需创建一个接口并使用注解的的方式来配置它
（以前是Dao接口上标注Mapper注解，现在是一个微服务接口上面标注一个feign注解即可），即可完成对服务提供方的接口绑定，简化了使用spring cloud ribbon时，
自动封装服务调用客户端的开发量。

--------------feign继承了ribbon---------------
利用ribbon维护了payment的服务列表信息，并且通过轮询实现客户端的负载均需。而与Ribbon不同的是，
通过feign只需要定义服务绑定接口并且以声明式的方法，优雅而简单的实现了服务调用。